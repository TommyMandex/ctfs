#-*- coding: utf-8 -*-

# Download Exploit Helper
import os
import sys

root_dir = "ctf_2018"

print_contents = True
overwrite_file = True # True = overwire file / False = append contents

def download(path):
	'''
	write your exploit code for file download
	[args] file path
	[return] file contents
	'''
	return 'test'

def main(path):
	save_path = root_dir + os.path.abspath(path)
	print "Save Path : ", save_path
	file_name = save_path.split("/")[-1]

	for dirs in save_path.split("/")[:-1]:
		if not os.path.exists("./"+dirs):
			os.makedirs(dirs)
		os.chdir(dirs)

	content = download(path)

	if content != False:
		if print_contents == True:
			print content

		if os.path.exists(file_name) and overwrite_file == False:
				fd = open(file_name, "ab")
				fd.write("\n\n")
		else:
			fd = open(file_name, "wb")

		fd.write(content)
		fd.close()

	else:
		print "Download Failed.."
		exit()


if __name__ == "__main__":

	if len(sys.argv) < 2:
		print "Usage : %s [File Path]\n" %sys.argv[0]
		exit()

	main(sys.argv[1])
